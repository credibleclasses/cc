<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8Z8YVWX9ZJ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-8Z8YVWX9ZJ');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="An exceptional institute for preparation of engineering/ medical exam (JEE/NEET) in very young age (pre-foundation)">
    <meta name="keywords"
        content="credible classes, credibleclasses, credible classes patna, credible classes Kankarbhag,credible classes Gandhi nagar,coaching center nearme,coaching for 6th class,coaching for 7th class,coaching for 8th class,coaching for NEET preparation patna,coaching 10th class,coaching centres bhoothnath">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/mediaqueries.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="shortcut icon" href="https://i.ibb.co/B3Wd2Wd/IMG-20230807-WA0020.jpg" type="image/x-icon">

    <title>Credible Classes</title>
</head>

<body>

    <div id="alert-container" class="position-absolute w-100 text-center" style="top: 0;"></div>


    <nav class="navbar navbar-expand-lg d-flex justify-content-between mb-4">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="newlogo.png" alt="Credeible-2-1" alt="Credeible-1" alt="Logo" width="180" height="50"
                    class="d-inline-block align-text-top">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse mx-md-2" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0 ">
                    <!-- <li class="nav-item">
                        <a class=" alink bold active" aria-current="page" href="#">Home</a>
                    </li> -->
                    <li class="nav-item">
                        <a class="underline-animation alink bold" id="nonvisiblenote" aria-current="page"
                            onclick="notes()">Notes</a>
                        <script>
                            function notes() {
                                const token = localStorage.getItem('token');

                                if (token) {
                                    window.location.href = 'notes.html'
                                } else {
                                    $('#custom-alert-modal').modal('show');
                                }
                            }
                        </script>
                        <!-- Modal -->
                        <div class="modal fade" id="custom-alert-modal" tabindex="-1"
                            aria-labelledby="custom-alert-modal-label" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h3 class="modal-title fs-5 bold" id="exampleModalLabel">Access Restricted</h3>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                            aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <h6>To view notes you must log in your account first</h6>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-warning"
                                            data-bs-dismiss="modal">Okay</button>

                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- log in modal -->
                    </li>
                    <li class="nav-item">
                        <a class="underline-animation alink bold " aria-current="page" onclick="result()">Result</a>

                        <script>
                            function result() {
                                const token = localStorage.getItem('token');

                                if (token) {
                                    window.location.href = 'result.html'
                                } else {
                                    $('#custom-alert-modal1').modal('show');
                                }
                            }
                        </script>
                        <!-- Modal -->
                        <div class="modal fade" id="custom-alert-modal1" tabindex="-1"
                            aria-labelledby="custom-alert-modal-label" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h3 class="modal-title fs-5 bold" id="exampleModalLabel">Access Restricted</h3>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                            aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <h6>To check your result you must log in your account first</h6>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-warning"
                                            data-bs-dismiss="modal">Okay</button>

                                    </div>
                                </div>
                            </div>
                        </div>


                    <li class="nav-item">
                        <a class="underline-animation alink bold" id="nonvisiblenote" aria-current="page"
                            onclick="attendance()">Attendance</a>
                        <script>
                            function attendance() {
                                const token = localStorage.getItem('token');

                                if (token) {
                                    window.location.href = 'attendance.html'
                                } else {
                                    $('#custom-alert-modal3').modal('show');
                                }
                            }
                        </script>
                        <!-- Modal -->
                        <div class="modal fade" id="custom-alert-modal3" tabindex="-1"
                            aria-labelledby="custom-alert-modal-label" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h3 class="modal-title fs-5 bold" id="exampleModalLabel">Access Restricted</h3>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                            aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <h6>To view your Attendance you must log in your account</h6>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-warning"
                                            data-bs-dismiss="modal">Okay</button>

                                    </div>
                                </div>
                            </div>
                        </div>




                    </li>
                    <li class="nav-item">
                        <a class="underline-animation alink bold" aria-current="page" href="notice.html">Notice</a>
                    </li>
                    <li class="nav-item">
                        <a class="underline-animation alink bold" aria-current="page" href="course.html">Courses</a>
                    </li>
                    <li class="nav-item">
                        <a class="underline-animation alink bold" aria-current="page" href="about.html">About</a>
                    </li>

                </ul>
                <div class="d-flex">

                    <div id="loginStatus">
                        <button type="button" class="btn btn-outline-warning me-3 ms-3  custom-border"
                            data-bs-toggle="modal" data-bs-target="#staticBackdrop"><i class="fa-solid fa-key"></i>
                            Student Log in</button>
                    </div>

                    <a id="adminbutton" class=" d-none d-md-block none"></a>
                </div>
                <a id="logoutbutton" class="ms-3 mb-1 btn btn-sm btn-danger custom-border none"
                    onclick="clearLocalStorage()">Log out</a>

            </div>
            <script>function clearLocalStorage() {
                    localStorage.clear();
                    location.href = "index.html"
                }
            </script>
        </div>
        </div>
    </nav>
    <!-- Modal -->


    <!-- Modal -->
    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Student Log in</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container">
                        <div id="loginresponse">

                        </div>
                        <div class="mb-3">
                            <label for="exampleFormControlInput1" class="form-label">Username</label>
                            <input type="text" class="form-control" value="" id="username"
                                placeholder="Enter Your Roll Number">
                        </div>
                        <div class="mb-3">
                            <label for="exampleFormControlInput1" class="form-label">Password</label>

                            <input type="text" class="form-control" value="" id="password"
                                placeholder="Enter Your Password">
                        </div>

                    </div>
                    <p class="text-danger text-sm-start" id="erroOnIncomplete"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger custom-border2" data-bs-dismiss="modal"> Cancel</button>
                    <button id="loginButton" class="btn btn-warning custom-border2"> Login</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <h2 class="text-center bold bottom-border">Your Attendance</h2>
    </div>

    <div class="container mt-3 mb-5">
        <div class="table-responsive mt-3">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Attendance Status</th>
                    </tr>
                </thead>
                <tbody id="studentTableBody">
                    <!-- This tbody will be populated dynamically with JavaScript -->
                </tbody>
            </table>
            <div id="loadingSpinner" class="text-center mt-3">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>
        </div>
    </div>

<script>
const token = localStorage.getItem('token');

// Fetch the student roll from the API using the token
async function fetchStudentRoll() {
    try {
        const response = await fetch('https://server-as2k.onrender.com/verify', {
            method: 'GET',
            headers: {
                'Authorization': `Bearer ${token}`
            }
        });

        const data = await response.json();
        return data.roll;
    } catch (error) {
        console.error('Error fetching student roll:', error);
        throw error;
    }
}

document.addEventListener("DOMContentLoaded", async function () {
    const studentroll = await fetchStudentRoll();
    try {
        const response = await fetch(`https://server-as2k.onrender.com/getattendance/${studentroll}`);
        const data = await response.json();

        const studentTableBody = document.getElementById('studentTableBody');
        const loadingSpinner = document.getElementById('loadingSpinner');

        // Clear any existing content in the table body
        studentTableBody.innerHTML = '';

        // Loop through the data array in reverse order
        for (let i = data.length - 1; i >= 0; i--) {
            const item = data[i];
            const row = document.createElement('tr');

            const dateCell = document.createElement('td');
            dateCell.textContent = item.Date;
            dateCell.classList.add('bold'); // Apply "bold" class
            row.appendChild(dateCell);

            const statusCell = document.createElement('td');
            statusCell.textContent = item.attendanceStatus;
            
            // Apply CSS class based on attendanceStatus
            if (item.attendanceStatus === 'Present') {
                statusCell.classList.add('text-success', 'bold'); // Apply green color and "bold" class
            } else if (item.attendanceStatus === 'Absent') {
                statusCell.classList.add('text-danger', 'bold'); // Apply red color and "bold" class
            }
             else if (item.attendanceStatus === 'Late') {
                statusCell.classList.add('text-warning', 'bold'); // Apply red color and "bold" class
            }
            
            row.appendChild(statusCell);

            studentTableBody.appendChild(row);
        }

        // Hide the loading spinner after data is loaded
        loadingSpinner.style.display = 'none';
    } catch (error) {
        console.error('Error fetching attendance data:', error);
    }
});






</script>

    <script src="scripts/admin.js"></script>
    <script src="scripts/loginapi.js">


    </script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="scripts/index.js">
    </script>
    <script src="https://kit.fontawesome.com/0a54405ea9.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
        crossorigin="anonymous"></script>
    <script src="scripts/Login.js"></script>
</body>

</html>
